# Клиенты авиакомпаний
## Классификация клиентов авиакомпании по удовлетворенности

### Из чего состоит проект

- `Analysis`: содержит все, что требовалось при анализе данных и построении моделей
- - `data_analysis_avia_clients.ipynb`: содержит аналитические изыскания для чистки и предобработки данных, плюс простейшие модели
- - `avia_classifier_fin.ipynb`: содержит анасамблевую модель градиентного бустинга и изыскания по сокращению признаков и подгону модели
- `data`: содержит рабочую модель, финальный набор данных, и прочие файлы для работы приложения
- `model.py`: файл для обучения модели, можно не использовать, файл модели лежит в папке data
- `functions.py`: файл с различными функциями для работы приложения
- `streamlit_app.py`: файл приложения


Тут мною решалась главная загвоздка - "-" в таргетном столбце! Как мне кажется - решение гениальное! Итак, я обучаю модель - градиентный бустинг, она скорее всего немного переобучилась и выдала средний скор в 96,5%, дальше я натравил ее на признаки для таргета "-" и получил какое-то предсказание, априори считаю что с в 96,5% случаях я попал. Дальше матчу эти предсказания в основной набор данных и сосдаю новую выборку, где "-" уже заменены на релевантные 0 и 1, дальше сновна натравливаю модель на поплненную выборку и обучаюсь.

В ТЕОРИИ эти нехитрым мувом я:

1. Избавился от преславутого "-"
2. Увеличил объем выборки
3. Внес в данные некоторый шум, ибо модель не точна, данные не точны, это должно мешать переобучению

Итак, моя модель лучше отличает негативных/нейтральных чем позитивных, и это даже хорошо, лучше выявлять неудовлетворенных и работать с ними, ориентироваться будем больше на метрику precision.

### Построение приложения

Не мудрствуя лукаво, взял шаблон и начал пилить приложение, форма для заполнения данных адаптирована, но вот дальше решился на эксперементы.

#### Генерируй, властвуй, унижай
Создал генератор случайных данных, подумал, что проверяющим и так надо очень много пересмотреть всякой дичи, пусть хоть я упрощу задачу!
Генератор создает набор данных под модель, включая имя, в процессе эот имя отбрасывается, модель предсказывает данные и имена мерджатся обратно, на выходе готовый нарандомленный набор с предсказанием

#### Настоящие данные никто не отменял
Идем дальше, может, кому-то понравится и он решит попробовать на своих данных, так пожалуйста!
Скачиваем шаблон (формат csv), заполняем данными, загружаем свой заполненный файл назад, получаем результат!
Шаблон уже содержит одну строку данных, для проверки можно просто вытащить его и положить назад, profit!
